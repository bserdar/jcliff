name=elytron
getContents=/subsystem=elytron:read-resource(recursive=true)
server.preprocess.prepend=/elytron

prefix.undefine=undefine:/elytron/
undefine.rule.1=/subsystem=elytron${cmdpath(${path(..)})}:undefine-attribute(name=${name(.)})
undefine.refresh=true

match.modifyProperty=modify:/elytron/*
modifyProperty.rule=/subsystem=elytron:write-attribute(name=${name(.)},value=${value(.)})

prefix.undefine=undefine:/elytron/
undefine.rule.1=/subsystem=logging${cmdpath(${path(..)})}:undefine-attribute(name=${name(.)})
undefine.refresh=true

match.addKeyStore=add:/elytron/key-store/*
addKeyStore.rule=/subsystem=elytron/key-store=${name(.)}:add(credential-reference=${value(credential-reference)}, ${if-defined (type),(,type=${value(type)})}, ${if-defined (path),(,path=${value(path)})})
addKeyStore.precedence=10
addKeyStore.refresh=true

match.removeKeyStore=remove:/elytron/key-store/*
removeKeyStore.rule=/subsystem=elytron/key-store=${name(.)}:remove
removeKeyStore.refresh=true
removeKeyStore.precedence=10

match.modifyKeyStore=modify:/elytron/key-store/*/*
modifyKeyStore.rule.1=/subsystem=elytron/key-store=${name(..)}:write-attribute(name=${name(.)},value=${value(.)})
modifyKeyStore.rule.2=:reload
modifyKeyStore.precedence=10

match.addKeyManager=add:/elytron/key-manager/*
addKeyManager.rule=/subsystem=elytron/key-manager=${name(.)}:add(credential-reference=${value(credential-reference)}, key-store=${value(key-store)}, , ${if-defined (algorithm),(,algorithm=${value(algorithm)})})
addKeyManager.precedence=20
addKeyManager.refresh=true

match.removeKeyManager=remove:/elytron/key-manager/*
removeKeyManager.rule=/subsystem=elytron/key-manager=${name(.)}:remove
removeKeyManager.refresh=true
removeKeyManager.precedence=20

match.modifyKeyManager=modify:/elytron/key-manager/*/*
modifyKeyManager.rule.1=/subsystem=elytron/key-manager=${name(..)}:write-attribute(name=${name(.)},value=${value(.)})
modifyKeyManager.rule.2=:reload
modifyKeyManager.precedence=20

match.addServerSslContext=add:/elytron/server-ssl-context/*
addServerSslContext.rule=/subsystem=elytron/server-ssl-context=${name(.)}:add(key-manager=${value(key-manager)})
addServerSslContext.precedence=30
addServerSslContext.refresh=true

match.removeServerSslContext=remove:/elytron/server-ssl-context/*
removeServerSslContext.rule=/subsystem=elytron/server-ssl-context=${name(.)}:remove
removeServerSslContext.refresh=true
removeServerSslContext.precedence=30

match.modifyServerSslContext=modify:/elytron/server-ssl-context/*/*
modifyServerSslContext.rule.1=/subsystem=elytron/server-ssl-context=${name(..)}:write-attribute(name=${name(.)},value=${value(.)})
modifyServerSslContext.rule.2=:reload
modifyServerSslContext.precedence=30